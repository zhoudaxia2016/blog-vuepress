---
title: "vim-and-command-line-tools"
date: "2019-11-18 18:01:33 +0800"
template: "post"
draft: false
slug: "vim-and-command-line-tools"
category: "develop"
tags:
  - "vim"
  - "shell"
  - "tool"
description: "linux哲学思想之一就是一个程序只要做好一件事，我觉得使用vim可以明显感觉到这一思想，或者说可以很好实践这一想法。"
---
  
linux哲学思想之一就是一个程序只要做好一件事，我觉得使用vim
可以明显感觉到这一思想，或者说可以很好实践这一想法。

vim可以调用外部程序来执行一些操作，比如使用!就可以在vim命令
模式下调用shell程序，这是最简单的一种方式。

下面记录的是我让vim和命令行工具结合的一些经验。

### 翻译

看文档时，有时会遇到不懂的英文单词，用鼠标复制，然后粘贴到
浏览器或者词典软件中，是一件重复且枯燥的工作。所以我找了一个
命令行词典工具[ydcv](https://github.com/felixonmars/ydcv)，
`ydcv your-word`即可翻译某个单词。其实使用哪个翻译工具都无
所谓，只要你喜欢即可。然后，如何与vim配合呢？我只考虑了一种
场景，就是光标就在当前你想要翻译的单词下，在normal模式下使用
`viwy`可以复制当前光标下的单词，然后在命令模式下执行`!/path/to/ydcv @0`
*@0*的0是vim寄存器的名字，存放着最近复制的内容，然后@是获取
寄存器内容的命令，*@0*就是刚刚复制的单词了。

当然，我们不可能每次都这样做，那样和原来方法的麻烦程度不相上下了。
我们可以将刚刚的操作用map写到一个快捷键里。

### fzf

最近才发现这个如此刚需的需求——查找文件并打开。就是一些编辑器的
*ctrl-p*快捷键的功能。虽然有如此多的vim插件可以使用，但是本人
是不造轮子不舒服的，所以还是希望自己去实现它，并且越简单越好。

[fzf](https://github.com/junegunn/fzf)是一个模糊查找工具。并
不只有查找文件的功能，只要你给输入它，也可以从输入中查找。所
以通过获取fzf命令的查找结果，然后用vim打开就可以了，应该是挺
简单的功能。

一开始想直接使用`system('fzf')`来直接获取fzf命令的结果，可是fzf
可以说是异步的命令，执行并不会立即给到结果，所以system返回的是
不对的。

想了很久，最后在知乎找到了一篇相关的内容[https://zhuanlan.zhihu.com/p/47506962](https://zhuanlan.zhihu.com/p/47506962)，这篇文章拯救了我，让我学习到了新的知识——term_start函数。

通过term_start函数，我们可以执行一个shell命令，执行结束后，我
们还能获取它的输入内容。原理还是很简单的，具体细节可参考给我启示
的那篇文章。

### Man

linux下，有个强大的男人，那就是man命令。只要我们对于一个命令不
是很熟悉，他都能悉心详细给我们讲解命令的用法。但是在终端中，man
的讲解文字是单调的，没有语法高亮的，看起来非常难受。

搜一下，然后我发现原来vim已经提供了man的帮助，只要我们执行
```
runtime! ftplugin/man.vim
```
就可以在vim中使用`Man shell-command-name`来获取命令的帮助说明，
并且提供语法高亮，可以使用vim的一些命令来查看，非常方便。

### Git

除了编辑器，我们开发最常用的工具就是git了。那要如何让它们两个
能够好好合作呢？

#### 1. 默认编辑器
我们可以设置vim作为commit时的使用的编辑器：
```
git config --global core.editor vim
```
或者在gitconfig文件里设置
```
[core]
    editor = vim
```
或者设置终端默认编辑器：
```
export EDITOR=vim
```

### 2.
